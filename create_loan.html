<!DOCTYPE html>
<html lang="en">
    <!-- ... -->
    <body>
        <!-- ... -->

        <!-- New Loan Form -->
        <form id="newLoanForm" action="create_loan.php" method="post" class="centered-form">
            <label for="borrower_id">Borrower ID:</label>
            <input type="text" id="borrower_id" name="borrower_id" onkeyup="fetchBorrowerDetails(this.value)" required>

            <label for="loan_amount">Loan Amount:</label>
            <input type="number" id="loan_amount" name="loan_amount" required>

            <label for="loan_date">Loan Date:</label>
            <input type="date" id="loan_date" name="loan_date" onchange="calculateDueDate(this.value)" required>

            <label for="loan_due_date">Loan Due Date:</label>
            <input type="date" id="loan_due_date" name="loan_due_date" readonly>

            <input type="submit" value="Create New Loan">
        </form>

        <script>
            // Function to calculate the loan due date
            function calculateDueDate(loan_date) {
                var loanDateObj = new Date(loan_date);
                loanDateObj.setDate(loanDateObj.getDate() + 30); // Add 30 days to loan date

                var loanDueDate = loanDateObj.toISOString().split('T')[0]; // Format the date as 'yyyy-mm-dd'
                document.getElementById('loan_due_date').value = loanDueDate;
            }

            // Function to fetch borrower details
            function fetchBorrowerDetails(input) {
                if (input.length >= 2) { // Only fetch details if input is at least 2 characters
                    fetch('fetch_borrower_details.php?input=' + input)
                        .then(response => response.json())
                        .then(data => {
                            // Populate form fields with borrower details
                            document.getElementById('borrower_id').value = data.id;
                        });
                }
            }
        </script>
    </body>
</html>